Index: app/src/main/java/indonesia/konfeksi/com/androidkonfeksi/service/FirebaseCloudMessagingService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package indonesia.konfeksi.com.androidkonfeksi.service;\r\n\r\nimport android.content.Intent;\r\nimport android.util.Log;\r\n\r\nimport com.google.firebase.messaging.FirebaseMessaging;\r\nimport com.google.firebase.messaging.FirebaseMessagingService;\r\nimport com.google.firebase.messaging.RemoteMessage;\r\n\r\nimport java.util.Map;\r\nimport indonesia.konfeksi.com.androidkonfeksi.activity.handleNotifikasi;\r\nimport indonesia.konfeksi.com.androidkonfeksi.activity.notifikasi;\r\nimport indonesia.konfeksi.com.androidkonfeksi.json.Notif;\r\n\r\npublic class FirebaseCloudMessagingService extends FirebaseMessagingService {\r\n    private static final String TAG = \"TOKENFIREBASE1\";\r\n    private static final String TITLE = \"title\";\r\n    private static final String EMPTY = \"\";\r\n    private static final String MESSAGE = \"message\";\r\n    private static final String IMAGE = \"image\";\r\n    private static final String ACTION = \"action\";\r\n    private static final String DATA = \"data\";\r\n    private static final String ACTION_DESTINATION = \"action_destination\";\r\n\r\n    @Override\r\n    public void onMessageReceived(RemoteMessage remoteMessage) {\r\n\r\n        Log.d(TAG, \"From: \" + remoteMessage.getFrom());\r\n\r\n        // Check if message contains a data payload.\r\n        if (remoteMessage.getData().size() > 0) {\r\n            Log.d(TAG, \"Message data payload: \" + remoteMessage.getData());\r\n            Map<String, String> data = remoteMessage.getData();\r\n            handleData(data);\r\n\r\n        } else if (remoteMessage.getNotification() != null) {\r\n            Log.d(TAG, \"Message Notification Body: \" + remoteMessage.getNotification().getBody());\r\n            handleNotification(remoteMessage.getNotification());\r\n        }// Check if message contains a notification payload.\r\n\r\n    }\r\n\r\n    private void handleNotification(RemoteMessage.Notification RemoteMsgNotification) {\r\n        String message = RemoteMsgNotification.getBody();\r\n        String title = RemoteMsgNotification.getTitle();\r\n        Notif notificationVO = new Notif();\r\n        notificationVO.setTitle(title);\r\n        notificationVO.setMessage(message);\r\n\r\n        Intent resultIntent = new Intent(getApplicationContext(), handleNotifikasi.class);\r\n        notifikasi notificationUtils = new notifikasi(getApplicationContext());\r\n        notificationUtils.displayNotification(notificationVO, resultIntent);\r\n        notificationUtils.playNotificationSound();\r\n    }\r\n\r\n    private void handleData(Map<String, String> data) {\r\n        String title = data.get(TITLE);\r\n        String message = data.get(MESSAGE);\r\n        String iconUrl = data.get(IMAGE);\r\n        String action = data.get(ACTION);\r\n        String actionDestination = data.get(ACTION_DESTINATION);\r\n        Notif notificationVO = new Notif();\r\n        notificationVO.setTitle(title);\r\n        notificationVO.setMessage(message);\r\n        notificationVO.setIconUrl(iconUrl);\r\n        notificationVO.setAction(action);\r\n        notificationVO.setActionDestination(actionDestination);\r\n\r\n        Intent resultIntent = new Intent(getApplicationContext(), handleNotifikasi.class);\r\n\r\n        notifikasi notificationUtils = new notifikasi(getApplicationContext());\r\n        notificationUtils.displayNotification(notificationVO, resultIntent);\r\n        notificationUtils.playNotificationSound();\r\n\r\n    }\r\n\r\n    private static final String TOPIC_GLOBAL = \"global\";\r\n    @Override\r\n    public void onNewToken(String s) {\r\n\r\n        super.onNewToken(s);\r\n\r\n        Log.d(TAG, \"Refreshed token: \" + s);\r\n        FirebaseMessaging.getInstance().subscribeToTopic(TOPIC_GLOBAL);\r\n        sendRegistrationToServer(s);\r\n\r\n    }\r\n\r\n    private void sendRegistrationToServer(String token) {\r\n        // TODO: Implement this method to send token to your app server.\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/src/main/java/indonesia/konfeksi/com/androidkonfeksi/service/FirebaseCloudMessagingService.java	(revision 3763194986cc34364d3b8783da79c3dbd17ab499)
+++ app/src/main/java/indonesia/konfeksi/com/androidkonfeksi/service/FirebaseCloudMessagingService.java	(date 1563781282720)
@@ -3,6 +3,7 @@
 import android.content.Intent;
 import android.util.Log;
 
+import com.google.firebase.iid.FirebaseInstanceId;
 import com.google.firebase.messaging.FirebaseMessaging;
 import com.google.firebase.messaging.FirebaseMessagingService;
 import com.google.firebase.messaging.RemoteMessage;
@@ -77,11 +78,10 @@
     private static final String TOPIC_GLOBAL = "global";
     @Override
     public void onNewToken(String s) {
-
         super.onNewToken(s);
+        s= FirebaseInstanceId.getInstance().getId();
+        Log.e(TAG, "Refreshed token: " + s);
 
-        Log.d(TAG, "Refreshed token: " + s);
-        FirebaseMessaging.getInstance().subscribeToTopic(TOPIC_GLOBAL);
         sendRegistrationToServer(s);
 
     }
Index: app/build.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>apply plugin: 'com.android.application'\r\napply plugin: 'com.google.gms.google-services'\r\nandroid {\r\n    compileSdkVersion 28\r\n    defaultConfig {\r\n        applicationId \"indonesia.konfeksi.com.androidkonfeksi\"\r\n        minSdkVersion 19\r\n        targetSdkVersion 28\r\n        versionCode 1\r\n        versionName \"1.0\"\r\n        testInstrumentationRunner \"android.support.test.runner.AndroidJUnitRunner\"\r\n    }\r\n    buildTypes {\r\n        release {\r\n            minifyEnabled false\r\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\r\n        }\r\n    }\r\n    allprojects {\r\n        tasks.withType(JavaCompile) {\r\n            options.compilerArgs << \"-Xlint:unchecked\" << \"-Xlint:deprecation\"\r\n        }\r\n    }\r\n}\r\n\r\ndependencies {\r\n    implementation fileTree(dir: 'libs', include: ['*.jar'])\r\n    implementation 'com.android.support:appcompat-v7:28.0.0'\r\n    implementation 'com.android.support.constraint:constraint-layout:1.1.3'\r\n    implementation 'com.android.support:recyclerview-v7:28.0.0'\r\n    implementation 'com.google.code.gson:gson:2.6.2'\r\n    implementation 'com.mcxiaoke.volley:library-aar:1.0.0'\r\n    implementation 'com.google.zxing:core:3.2.1'\r\n    implementation 'com.journeyapps:zxing-android-embedded:3.2.0@aar'\r\n    implementation 'com.squareup.retrofit2:retrofit:2.3.0'\r\n    implementation 'com.squareup.retrofit2:converter-gson:2.3.0'\r\n    implementation 'com.android.support:design:28.0.0'\r\n    implementation 'com.android.support:support-v4:28.0.0'\r\n    testImplementation 'junit:junit:4.12'\r\n    implementation 'com.android.support:cardview-v7:28.0.0'\r\n    androidTestImplementation 'com.android.support.test:runner:1.0.2'\r\n    androidTestImplementation 'com.android.support.test.espresso:espresso-core:3.0.2'\r\n    implementation 'com.jakewharton:butterknife:8.8.1'\r\n    implementation 'com.squareup.retrofit2:retrofit:2.4.0'\r\n    implementation 'com.karumi:dexter:5.0.0'\r\n\r\n    implementation 'com.squareup.retrofit2:converter-gson:2.4.0'\r\n    annotationProcessor 'com.jakewharton:butterknife-compiler:8.8.0'\r\n    implementation 'com.google.firebase:firebase-messaging:17.3.4'\r\n    implementation 'com.google.firebase:firebase-auth:11.8.0'\r\n    implementation 'com.google.firebase:firebase-database:11.8.0'\r\n    implementation 'com.firebaseui:firebase-ui-database:0.4.0'\r\n    implementation 'com.google.firebase:firebase-storage:11.8.0'\r\n\r\n    implementation 'com.google.firebase:firebase-firestore:11.8.0'\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- app/build.gradle	(revision 3763194986cc34364d3b8783da79c3dbd17ab499)
+++ app/build.gradle	(date 1563780876635)
@@ -53,4 +53,6 @@
     implementation 'com.google.firebase:firebase-storage:11.8.0'
 
     implementation 'com.google.firebase:firebase-firestore:11.8.0'
+
+
 }
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"CMakeSettings\">\r\n    <configurations>\r\n      <configuration PROFILE_NAME=\"Debug\" CONFIG_NAME=\"Debug\" />\r\n    </configurations>\r\n  </component>\r\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_1_8\" project-jdk-name=\"1.8 (1)\" project-jdk-type=\"JavaSDK\">\r\n    <output url=\"file://$PROJECT_DIR$/build/classes\" />\r\n  </component>\r\n  <component name=\"ProjectType\">\r\n    <option name=\"id\" value=\"Android\" />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- .idea/misc.xml	(revision 3763194986cc34364d3b8783da79c3dbd17ab499)
+++ .idea/misc.xml	(date 1563764960430)
@@ -5,7 +5,7 @@
       <configuration PROFILE_NAME="Debug" CONFIG_NAME="Debug" />
     </configurations>
   </component>
-  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_8" project-jdk-name="1.8 (1)" project-jdk-type="JavaSDK">
+  <component name="ProjectRootManager" version="2" languageLevel="JDK_1_7" project-jdk-name="1.8" project-jdk-type="JavaSDK">
     <output url="file://$PROJECT_DIR$/build/classes" />
   </component>
   <component name="ProjectType">
Index: gradle.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># Project-wide Gradle settings.\r\n# IDE (e.g. Android Studio) users:\r\n# Gradle settings configured through the IDE *will override*\r\n# any settings specified in this file.\r\n# For more details on how to configure your build environment visit\r\n# http://www.gradle.org/docs/current/userguide/build_environment.html\r\n# Specifies the JVM arguments used for the daemon process.\r\n# The setting is particularly useful for tweaking memory settings.\r\norg.gradle.jvmargs=-Xmx1536m\r\n# When configured, Gradle will run in incubating parallel mode.\r\n# This option should only be used with decoupled projects. More details, visit\r\n# http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects\r\n# org.gradle.parallel=true\r\n\r\n\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>windows-1252
===================================================================
--- gradle.properties	(revision 3763194986cc34364d3b8783da79c3dbd17ab499)
+++ gradle.properties	(date 1563762684869)
@@ -6,7 +6,7 @@
 # http://www.gradle.org/docs/current/userguide/build_environment.html
 # Specifies the JVM arguments used for the daemon process.
 # The setting is particularly useful for tweaking memory settings.
-org.gradle.jvmargs=-Xmx1536m
+org.gradle.jvmargs=-Xmx1024m
 # When configured, Gradle will run in incubating parallel mode.
 # This option should only be used with decoupled projects. More details, visit
 # http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects
